<!DOCTYPE html>
<html>
<head>
    <meta name="author" content="Piotr Puldzian Płucienniczak" />
    <meta name="description" content="Pętla historii zaciska się." />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link type="text/css" rel="stylesheet" href="firmator.css" />
    <script src="libs/jquery-2.1.4.min.js"></script>
    <script src="libs/seedrandom.min.js"></script>
    <script src="branze.js"></script>
    <script src="firmy.js"></script>
    <script src="firmator.js"></script>
    <title>ZAŁÓŻ FIRMY | Puldzian</title>
</head>

<body>

<div class="wszystko">
  <!-- To kontroluje całą stronkę. -->
  <div class="srodek">
        <!-- FIRMA -->
      <div class="zawartoscsrodka">
        <!-- <p>Firma</p> -->
        <div class="nazwa">
          <span id="jsFirma1">1</span>
          <span id="jsFirma2">2</span>
          <span id="jsFirma3">3</span>
        </div>

        <!-- BRANŻA -->
        <div class="branza">
          <!-- <p>Branża</p> -->
          <div id="jsBranza1"><br/><br/></div>
        </div>


        <!-- PRZYCISK -->
        <div class="przyciski">
            <button class="click-trigger" data-click-id="click-001" id="jsButtonFirma" onclick="rozrusznik()">DAJ NOWO FIRME</button>
        </div>
      </div>
  </div>
  <!-- tu jest stopka -->
  <div class="dolek">
    <div class="zawartoscdolka">
      <p>Ojczyzna jest w potrzebie! Musisz założyć firmę, żeby generować produkt narodowy brutto i załatać dziurę budżetową.</p>

      <?php

      $clickcount = explode("\n", file_get_contents('counter.txt'));
      foreach($clickcount as $line){
      	$tmp = explode('||', $line);
      	$count[trim($tmp[0])] = trim($tmp[1]);
      	}

      ?>

      <p>Założono firm: <span id="click-001"><?php echo $count['click-001'];?></span></p>
    </div>
  </div>
</div>

<!-- http://www.dynamicdrive.com/forums/entry.php?322-Click-Counter-with-Flat-File-Storage-(text-file)-AJAX-amp-PHP -->
<script>
var clicks = document.querySelectorAll('.click-trigger'); // IE8
for(var i = 0; i < clicks.length; i++){
	clicks[i].onclick = function(){
		var id = this.getAttribute('data-click-id');
		var post = 'id='+id; // post string
		var req = new XMLHttpRequest();
		req.open('POST', 'counter.php', true);
		req.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
		req.onreadystatechange = function(){
			if (req.readyState != 4 || req.status != 200) return;
			document.getElementById(id).innerHTML = req.responseText;
			};
		req.send(post);
		}
	}
</script>

</body>
</html>
